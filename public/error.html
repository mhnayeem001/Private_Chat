<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error - Private Chat App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body class="min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-200">
    <div class="min-h-screen flex items-center justify-center p-4">
        <div class="max-w-md w-full space-y-8">
            <!-- Header -->
            <div class="text-center">
                <div class="mx-auto h-16 w-16 flex items-center justify-center rounded-full bg-red-100 dark:bg-red-900">
                    <svg class="h-8 w-8 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.996-.833-2.464 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                    </svg>
                </div>
                <h2 id="errorTitle" class="mt-6 text-3xl font-extrabold text-gray-900 dark:text-white">
                    Chat Not Available
                </h2>
                <p id="errorMessage" class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                    This chat link is no longer valid or has expired.
                </p>
            </div>

            <!-- Theme Toggle -->
            <div class="flex justify-center">
                <button 
                    id="themeToggle"
                    class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"
                    title="Toggle theme"
                >
                    <svg id="sunIcon" class="h-5 w-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <svg id="moonIcon" class="h-5 w-5 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                </button>
            </div>

            <!-- Error Details -->
            <div class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-md border border-gray-200 dark:border-gray-700">
                <div id="errorDetails" class="space-y-4">
                    <!-- Error-specific content will be populated by JavaScript -->
                </div>

                <div class="mt-6 space-y-3">
                    <a href="/" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors">
                        Go to Home Page
                    </a>
                    <a href="/login" class="w-full flex justify-center py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors">
                        Create New Chat
                    </a>
                </div>
            </div>

            <!-- Help -->
            <div class="text-center text-xs text-gray-500 dark:text-gray-400 space-y-1">
                <p>Need help? Try creating a new chat link or contact support.</p>
            </div>
        </div>
    </div>

    <script src="/js/main.js"></script>
    <script>
        // Parse error type from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const errorType = urlParams.get('type') || 'unknown';

        const errorConfig = {
            invalid_token: {
                title: 'Invalid Chat Link',
                message: 'This chat link is invalid, expired, or has already been used.',
                details: [
                    'Chat links expire after 5 minutes',
                    'Links can only be used once',
                    'Maximum 2 people can join each chat',
                    'Links become invalid after the chat is full'
                ]
            },
            room_full: {
                title: 'Chat Room Full',
                message: 'This chat room already has the maximum number of participants.',
                details: [
                    'Each chat room supports only 2 people',
                    'The link becomes invalid once 2 people have joined',
                    'Ask the chat creator for a new link if needed'
                ]
            },
            expired: {
                title: 'Link Expired',
                message: 'This chat link has expired and is no longer valid.',
                details: [
                    'Chat links automatically expire after 5 minutes',
                    'This is for security and privacy reasons',
                    'Create a new chat link to start a conversation'
                ]
            },
            unknown: {
                title: 'Chat Not Available',
                message: 'Sorry, this chat is not available right now.',
                details: [
                    'The link may be invalid or expired',
                    'The server may have restarted (clearing all chats)',
                    'Try creating a new chat link'
                ]
            }
        };

        const config = errorConfig[errorType] || errorConfig.unknown;

        // Update page content
        document.getElementById('errorTitle').textContent = config.title;
        document.getElementById('errorMessage').textContent = config.message;

        // Populate error details
        const detailsContainer = document.getElementById('errorDetails');
        const detailsList = document.createElement('ul');
        detailsList.className = 'list-disc list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400';

        config.details.forEach(detail => {
            const li = document.createElement('li');
            li.textContent = detail;
            detailsList.appendChild(li);
        });

        detailsContainer.appendChild(detailsList);

        // Update page title
        document.title = `${config.title} - Private Chat App`;
    </script>
</body>
</html>
